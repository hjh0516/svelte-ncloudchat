---
search:
  keyword: ["ncloudchat"]
---

# NCLOUD Chat Javascript SDK

## Authentification

### 1. 대시보드에서 설정에서 프로젝트ID 를 확인 합니다. 
[ncloudchat.min.js](https://kr.object.ncloudstorage.com/ncloudchat/ncloudchat.min.js) 을 다운로드 합니다.

<script src="ncloudchat.min.js"></script>

를 <head> </head> 사이에 추가 합니다.

엔클라우드챗을 사용하기전에 인스턴스를 초기화 해야 합니다. 대시보드에서 확인한 프로젝트ID 를 추가해 주세요.

```javascript
const chat = new ncloudchat.Chat();
chat.initialize(projectId);
```

### 2. Connect to NCloud Chat Server

- 초기화가 완료되면 사용자명, 이름, 프로필 이미지주소(옵션) 을 입력 후에 접속해야 합니다. 

```javascript
const user = await chat.connect({
    id: USERNAME,
    name: NAME,
    profile: PROFILE_URL
}, TOKEN);
```

| ID         | type   | desc        |
| :--------- | :----- | :---------- |
| USERNAME | string |  아이디 |
| NAME | string | 이름 |
| PROFILE_URL | string | 프로필 주소 |
| TOKEN | string | 토큰 값 |


### 3. Disconnect from NCloud Chat Server

 - 사용자의 연결을 끊을려면 disconnect() 함수를 호출하면 됩니다

```javascript
await chat.disconnect();
```

## Communication

### 1. Subscribe / Unsubscribe

- 원하는 채널에 가입(방 참여) 합니다. 참여된 채널에는 unsubscribe 할때까지 재접속시에도 자동으로 참여됩니다.

```javascript
chat.subscribe(CHANNEL_ID);
```

- 해당 채널에 대한 가입을 해지 합니다.  해당 채널에 메시지를 더 이상 받을 수 없습니다.
```javascript
chat.unsubscribe(CHANNEL_ID);
```

| ID         | type   | desc        |
| :--------- | :----- | :---------- |
| CHANNEL_ID | string | 채널 아이디 |


### 2. SendMessage

- 특정 채널로 간단한 메시지 보내는 방법을 보여줍니다.

```javascript
await chat.sendMessage(CHANNEL_ID, {
      type: "text", 
      message: MESSAGE
});
```

| ID         | type   | desc               |
| :--------- | :----- | :----------------- |
| CHANNEL_ID | string | 채널 아이디        |
| type    | string | 보내는 메시지 종류  |
| MESSAGE    | string | 전송 메시지 텍스트 |

### 2. SendImage

- 특정 채널로 이미지 파일을 전송할 수 있습니다.
```html
<input type="file" id="uploadfile" name="file" onChange={fileUpload} />
```

```javascript
await chat.sendImage(CHANNEL_ID,file);
```

| ID         | type   | desc               |
| :--------- | :----- | :----------------- |
| CHANNEL_ID | string | 채널 아이디        |
| file    | string | 보내는 메시지 종류  |

## Event

### Binding Event

- 다양한 수신하는 이벤트에 대해, 이벤트 핸들러를 등록/해제 할 수 있습니다,

```javascript
// 메시지 수신
chat.bind('onMessageReceived',function(channel, message) {        
});
// 오류 메시지
chat.bind('onErrorReceived',function(error) {
});
// 접속 성공
chat.bind('onConnected',function(socket) {
});
// 접속 종료
chat.bind('onDisconnected',function(reason) { 
});
```

## Client API

### 1-1. Subscription

 - Subscription Data Class 

| ID         | type   | desc          |
| :--------- | :----- | :------------ |
| id         | string | 유니크 아이디 |
| channel_id | string | 채널 아이디   |
| user_id    | string | 유저 고유 아이디   |
| created_at | string | 생성 일자     |
| online | boolean | 온라인 여부     |
| push | boolean | 푸시 참여 여부     |
| language | string | 접속 언어    |
| mark.user_id | string | 마지막 메시지 보낸 사용자     |
| mark.message_id | string | 마지막 메시지 아이디     |
| mark.sort_id | string | 마지막 메시지 정렬ID     |

### 1-2. getSubscriptions

 - (특정 채널에 대해) 참여자 리스트를 가져올 수 있습니다.

```javascript
const filter = {channel_id:channelId};
const sort = {created_at:-1};
const option = { offset:0, limit:100};
const subscriptions = await chat.getSubscriptions(filter, sort, option);
console.log(subscriptions);
```

### 2-1. Channel

 - Channel Data Class 

| ID         | type   | desc                         |
| :--------- | :----- | :--------------------------- |
| id         | string | 채널 아이디(unique)     |
| project_id | string | 프로젝트 아이디              |
| unique_id | string |  개발사에서 설정 가능한 채널 아이디 (unique) |
| name       | string | 채널 이름                  |
| user_id     | string | (채널 생성한) 유저 아이디    |
| unique_id  | string | 채널 고유ID |
| default_lang | string | 기본 언어 |
| lang | string | 현재 접속중인 이용자의 언어 |
| members | string | Private 일 경우 참여된 사용자 목록 |
| push | boolean | 푸시 메시지 지원 여부 (Private 채널 일 경우)
| state | boolean | 채널 상태 |
| created_at | string | 생성 일자                    |
| updated_at | string | 갱신 일자                    |


### 2-2. getChannels

 - (프로젝트 내) 전체 채널 리스트를 가져올 수 있습니다.

```javascript
const filter = {state:true};
const sort = {created_at:-1};
const option = { offset:0, limit:100};
const channels = await chat.getChannels(filter,sort,option);
console.log(channels);
```

| ID         | type   | desc                         |
| :--------- | :----- | :--------------------------- |
| FILTER     | string    |  사용자가 사용할 필터 입니다. 모든 필드에 대해서 쿼리를 하실 수 있습니다.     |
| SORT     | string    | 정렬을 할 수 있습니다. (ascending (1) or descending (-1))          |
| OPTION    | string    | 페이징 및 선택 옵션들 추가할 수 있습니다. |

### 2-3. getChannel

- 개별 채널에 대한 정보를 가져올 수 있습니다.

```javascript
const channel = await chat.getChannel(id);
```

### 2-4. createChannel

- 신규 채널을 생성합니다.

```javascript
const channel = await chat.createChannel({type:"PUBLIC",name:"CHANNEL NAME"});
```

### 2-5. deleteChannel

- 해당 채널을 삭제합니다. ( 한 개부터 여러개 삭제가 가능합니다.)

```javascript
const channel = await chat.deleteChannel([CHANNEL_ID, CHANNEL_ID, CHANNEL_ID]);
```

### 2-6. updateChannel
- 채널 정보를 업데이트 합니다.

```javascript
const channel = await chat.updateChannel({id: CHANNEL_ID, type:"PUBLIC",name:"CHANNEL NAME"});
```

### 3-1. Message

 - Message Data Class 

| ID         | type   | desc                         |
| :--------- | :----- | :--------------------------- |
| id         | string | 아이디(unique)     |
| message_id | string | 메시지 아이디              |
| sort_id | string |  메시지 정렬을 위한 ID |
| message_type       | string | 메시지 종류                  |
| sender.id     | string | 보낸 사람 ID   |
| sender.name  | string | 보낸 사람 이름 |
| sender.profile | string | 보낸 사람 프로필 이미지 |
| metions | string | 맨션된 리스트 |
| metions_everyone | string | 전체 맨션 여부 |
| content | string | 메시지
| created_at | string | 생성 일자                    |
| sended_at | string | 보낸 일자                    |
### 2-3. getChannel

- 개별 메시지에 대한 정보를 가져올 수 있습니다.

```javascript
const channel = await chat.getMessage(message_id);
```

### 3-1. getMessages

 - (특정 채널에 대해) Message 데이터를 리스트 형태로 가져올 수 있습니다.

```javascript
const filter = {channel_id: CHANNEL_ID};
const sort = {created_at:-1}; 
const option = { offset:0, limit:100};
const messages = await chat.getMessages(filter, sort, option);
console.log(messages);
```

| ID         | type   | desc                         |
| :--------- | :----- | :--------------------------- |
| FILTER     | string    |  사용자가 사용할 필터 입니다. 모든 필드에 대해서 쿼리를 하실 수 있습니다.     |
| SORT     | string    | created_at: -1 or created_at:1 옵션만 사용가능 합니다.      |
| OPTION    | string    | 페이징 및 선택 옵션들 추가할 수 있습니다. |

### 3-3. translateMessage

 - (자동번역 기능이 활성화 되어 있을 경우) 임의의 텍스트를 (지정한 언어로) 번역할 수 있습니다.

> 해당 기능은, NaverCloud PAPAGO NMT 상품을 함께 연동할 경우 사용 가능합니다. [[ NCP Papago NMT ]](https://www.ncloud.com/product/aiService/papagoNmt)

 - (Received) Translation Data Class

```javascript
const message = await chat.translateMessage(CHANNEL_ID, { source_lang: SORCE_LANG, target_lang: TARTGET_LANG, message: MESSAGE, direct: DIRECT });
```

| ID         | type   | desc                         |
| :--------- | :----- | :--------------------------- |
| SORCE_LANG     | string    |  원본 언어(source language)의 언어 코드    |
| TARTGET_LANG     | string    |   목적 언어(target language)의 언어 코드   |
| MESSAGE    | string    | 번역할 텍스트. 1회 호출 시 최대 5,000자까지 번역할 수 있습니다.|
| DIRECT | boolean | 번역된 메시지를 즉시 발송 합니다. (option) |

